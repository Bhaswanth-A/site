<!DOCTYPE html><html lang="en">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"><title>ROS Basics - Automation & Robotics Club</title>

<meta name="description" content="Basics of ROS ecosystem have been covered">
<link rel="canonical" href="https://arc-bphc.github.io/site/projects/2021-05-04-ROS-Baiscs.html"><link rel="alternate" type="application/rss+xml" title="Automation & Robotics Club" href="/site/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="/site/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/site/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/site/assets/favicon-16x16.png"><link rel="manifest" href="/site/assets/site.webmanifest"><link rel="mask-icon" href="/site/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="/site/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/site/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet --><link rel="stylesheet" href="/site/assets/css/main.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css" ><!-- start custom head snippets -->

<!-- end custom head snippets -->
<!-- Jekyll Ideal Image Slider Include -->
<!-- https://github.com/jekylltools/jekyll-ideal-image-slider-include -->
<!-- v1.8 -->
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();
(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();
(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();
<!-- Jekyll Ideal Image Slider Include -->
<!-- https://github.com/jekylltools/jekyll-ideal-image-slider-include -->
<!-- v1.8 --></script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.6',
      sources: {
        font_awesome: 'https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.1/css/all.css',
        jquery: 'https://cdn.bootcss.com/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js',
        chart: 'https://cdn.bootcss.com/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdn.bootcss.com/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.bootcss.com/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.bootcss.com/mermaid/8.0.0-rc.8/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/site/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script>
</head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__viewport has-aside cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header"><div class="main">
      <div class="header__title">
        <div class="header__brand">
          <div class="header__brand">
            <img src="/site/assets/images/logo/logo.png"/><a
              title="Automation & Robotics Club, BITS Pilani Hyderabad Campus
"
              href="/site/">
            </a></div><a title="Automation & Robotics Club, BITS Pilani Hyderabad Campus
" href="/site/">Automation & Robotics Club</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul>
          <!--<li class="navigation__item"><a href="/site/projects/">Projects</a></li><li class="navigation__item"><a href="/site/resources/">Resources</a></li><li class="navigation__item"><a href="/site/blog/">Blog</a></li><li class="navigation__item"><a href="/site/archive/">Archive</a></li><li class="navigation__item"><a href="https://arc-bphc.github.io#about">About</a></li>-->
          <!-- <div class="navbar">
            <a href="/site/projects/">Projects</a>
            <a href="/site/resources">Resources</a>
            <a href="/site/blog">Blog</a>
            <a href="https://arc-bphc.github.io#about">About</a>
            <div class="dropdown">
              <button class="dropbtn">Others 
                <i class="fa fa-caret-down"></i>
              </button>
              <div class="dropdown-content">
                <a href="/site/archive">Archive</a>
                <a href="#">Our Team</a>
                <a href="#">Publications</a>
                <a href="#">Skill Tree</a>
              </div>
            </div> 
          </div> -->
          <div class="topnav" id="myTopnav">
            <a href="/site/projects/" class="active">Projects</a>
            <a href="/site/resources">Resources</a>
            <a href="/site/blog">Blog</a>
            <div class="dropdown">
              <button class="dropbtn">Others 
                <i class="fa fa-caret-down"></i>
              </button>
              <div class="dropdown-content">
                <a href="/site/archive">Archive</a>
                <a href="/site/team/">Our Team</a>
                <a href="#">Publications</a>
                <a href="#">Skill Tree</a>
              </div>
            </div> 
            <a href="https://arc-bphc.github.io#about">About</a>
            <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="myFunction()">&#9776;</a>
          </div><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>

<script>
function myFunction() {
  var x = document.getElementById("myTopnav");
  if (x.className === "topnav") {
    x.className += " responsive";
  } else {
    x.className = "topnav";
  }
}
</script>

<style>
body {margin:0;font-family:Arial}

.topnav {
  overflow: hidden;
  background-color: #202020;
}

.topnav a {
  float: left;
  display: block;
  color: #202020;
  text-align: center;
  padding: 3px 5px;
  text-decoration: none;
  font-size: 16px;
}

.active {
  color: #202020;
}

.topnav .icon {
  display: none;
}

.dropdown {
  float: left;
  overflow: hidden;
}

.dropdown .dropbtn {
  font-size: 16px;    
  border: none;
  outline: none;
  padding: 3px 5px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #202020;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  float: none;
  color: #202020;
  padding: 3px px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.topnav a:hover, .dropdown:hover .dropbtn {
  background-color: #202020;
  color: #ff9500;
}

.dropdown-content a:hover {
  background-color: #202020;
  color: black;
}

.dropdown:hover .dropdown-content {
  display: block;
}

@media screen and (max-width: 600px) {
  .topnav a:not(:first-child), .dropdown .dropbtn {
    display: none;
  }
  .topnav a.icon {
    float: right;
    display: block;
  }
}

@media screen and (max-width: 600px) {
  .topnav.responsive {position: relative;}
  .topnav.responsive .icon {
    position: absolute;
    right: 0;
    top: 0;
  }
  .topnav.responsive a {
    float: none;
    display: block;
    text-align: left;
  }
  .topnav.responsive .dropdown {float: none;}
  .topnav.responsive .dropdown-content {position: relative;}
  .topnav.responsive .dropdown .dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}
</style>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
<!-- <style>
body {
  font-family: Arial, Helvetica, sans-serif;
}

.navbar {
  overflow: hidden;
  background-color: #202020;
}

.navbar a {
  float: left;
  font-size: 16px;
  color: #202020;
  text-align: center;
  padding: 3px 5px;
  text-decoration: none;
}

.dropdown {
  float: left;
  overflow: hidden;
}

.dropdown .dropbtn {
  font-size: 16px;  
  border: none;
  outline: none;
  padding: 3px 5px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.navbar a:hover, .dropdown:hover .dropbtn {
  background-color: #202020;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #202020;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  float: none;
  color: black;
  padding: 3px 5px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.dropdown-content a:hover {
  background-color: #202020;
}

.dropdown:hover .dropdown-content {
  display: block;
}
</style> --></div><div class="page__content"><img class="article__header--cover" src="/site/screenshot.jpg" /><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div>
</aside></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet -->
<article itemscope itemtype="http://schema.org/Article"><div class="article__header"><header><h1>ROS Basics</h1></header><span class="split-space">&nbsp;</span>
          <a class="edit-on-github"
            title="Edit on Github"
            href="https://github.com/arc-bphc/site/tree/master/_projects/2021-05-04-ROS-Baiscs.md">
            <i class="far fa-edit"></i></a></div><meta itemprop="headline" content="ROS Basics"><div class="article__info clearfix"><ul class="left-col menu"><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=ros">ros</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=topics">topics</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=services">services</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=actions">actions</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=packages">packages</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/site/archive/# "archive/" (default)?tag=launch">launch</a>
            </li></ul></div><meta itemprop="author" content="Automation  & Robotics Club"/><meta itemprop="datePublished" content="2021-05-04T16:17:25+05:30">
    <meta itemprop="keywords" content="ros,topics,services,actions,packages,launch"><div class="js-article-content"><!-- Jekyll Ideal Image Slider Include -->
<!-- https://github.com/jekylltools/jekyll-ideal-image-slider-include -->
<!-- v1.8 -->


<!-- Jekyll Ideal Image Slider Include -->
<!-- https://github.com/jekylltools/jekyll-ideal-image-slider-include -->
<!-- v1.8 --><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet -->
<div class="article__content" itemprop="articleBody"><p>Basics of ROS ecosystem have been covered
<!--more--></p>
<h2 id="packages">Packages</h2>
<p>ROS uses packages to orgnaize its program, you can think of a package as all the files that a specific ROS program needs to run sucessfully. 
A few common items inside a package:</p>

<ul>
  <li><strong>launch</strong> - contains launch files</li>
  <li><strong>src</strong> - contains the source files</li>
  <li><strong>CMakeLists.txt</strong> - contains the rules for compilation</li>
  <li><strong>package.xml</strong> - package info and depends</li>
</ul>

<p>You can use roscd to go to any package in ROS
<code class="language-plaintext highlighter-rouge">roscd &lt;package_name&gt;</code></p>

<h3 id="creating-ros-packages">Creating ROS Packages</h3>
<p>All packages must be created inside <code class="language-plaintext highlighter-rouge">~/catkin_ws/src</code></p>

<p><strong>To create a package the following synatx can be used:</strong></p>

<p><code class="language-plaintext highlighter-rouge">catkin_create_pkg &lt;package_name&gt; &lt;package_depends&gt;</code></p>

<h3 id="compiling-ros-packages">Compiling ROS Packages</h3>
<p>Once a package has been created, it needs to be compiled in order for it to work.</p>

<p><code class="language-plaintext highlighter-rouge">catkin_make</code> - Will compile the entire src directory and needs to be issued only in the catkin_ws directory.
<code class="language-plaintext highlighter-rouge">catkin_make --only-pkg-with-deps &lt;package_name&gt;</code> - Will only compile the selected package.</p>

<h2 id="nodes">Nodes</h2>
<p>Nodes are individual ROS programs that together with other nodes form a working structure.</p>

<p><strong>To launch a node from the terminal:</strong>
<code class="language-plaintext highlighter-rouge">rosrun &lt;package_name&gt; &lt;node_name&gt; __name:=new_node_name __ns:=name_space topic:=new_topic</code></p>

<p><strong>To get a list of nodes that are currently active:</strong>
<code class="language-plaintext highlighter-rouge">rosnode list</code></p>

<p><strong>To get more information about a paticular node:</strong>
<code class="language-plaintext highlighter-rouge">rosnode info /node_name</code></p>

<h2 id="launch-files">Launch Files</h2>
<p>All launch files are contained inside the <code class="language-plaintext highlighter-rouge">&lt;launch&gt;</code> tags. Launch files are used to “launch” nodes/programs in ROS. One of the major advantages of launch files is the fact that you can launch multiple nodes at once.</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;launch&gt;</span>  
    <span class="nt">&lt;include</span> <span class="na">file=</span><span class="s">"$(find package_where_launch_is)/launch/my_launch_file.launch"</span><span class="nt">/&gt;</span>  
    <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">"package_name"</span> <span class="na">type=</span><span class="s">"script_name.py"</span> <span class="na">name=</span><span class="s">"node_name"</span> <span class="na">output=</span><span class="s">"screen"</span> <span class="na">respawn=</span><span class="s">"false"</span> <span class="na">ns=</span><span class="s">"w"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">"/current_topic"</span> <span class="na">to=</span><span class="s">"/needed_topic"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/node&gt;</span>
<span class="nt">&lt;/launch&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="parameter-server">Parameter Server</h2>
<p>A parameter server is a dictonary that ROS uses to store parameters. Any ROS program can access these parameters during runtime to customize itself accordingly. The following commands can be used to interact with the parameter server.</p>

<p><code class="language-plaintext highlighter-rouge">rosparam list</code> - Gets a list of parameter names that can be accessed
<code class="language-plaintext highlighter-rouge">rosparam get &lt;parameter_name&gt;</code> - Gets the current value of that parameter
<code class="language-plaintext highlighter-rouge">rosparam set &lt;parameter_name&gt; &lt;value&gt;</code> - Updates the parameter value</p>

<h2 id="topics">Topics</h2>

<p>ROS Nodes communicate with each other via communication channels called “Topics”, further messages are passed between nodes through topics. Every topic has a message type that it supports communication over. Nodes can subscribe to a topic to listen to data from other nodes or publish to topics to send data to other nodes which are subscribed to a given topic.</p>

<p><strong>To check for active topics:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rostopic list</code></p>

<p><strong>For more information about a topic:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rostopic info /topic_name</code></p>

<p><strong>To publish to a topic at a rate of x Hz:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rostopic pub -r x /topic_name /message_type args</code></p>

<p><strong>To Listen to a topic:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rostopic echo /topic_name</code></p>

<h3 id="simple-publisher">Simple Publisher</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'node_name'</span><span class="p">)</span>
<span class="n">pub</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s">'/topic_name'</span><span class="p">,</span> <span class="n">String</span><span class="p">,</span> <span class="n">latch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Rate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># 10hz
</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">rospy</span><span class="p">.</span><span class="n">is_shutdown</span><span class="p">():</span>
   <span class="n">pub</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="s">"hello world"</span><span class="p">)</span>
   <span class="n">r</span><span class="p">.</span><span class="n">sleep</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="simple-subscriber">Simple Subscriber</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>

<span class="k">def</span> <span class="nf">callback_function</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">data</span>
    <span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'node_name'</span><span class="p">)</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">'/topic_name'</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">callback_function</span><span class="p">)</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="messages">Messages</h2>
<p>As explained before data is sent via messages inside topics. ROS has a rich set of predefined messages that can be used.</p>

<p><strong>To find out more infomation about a paticular message:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rosmsg show &lt;package_name&gt;/&lt;message&gt;</code></p>

<p>You can get more information about what message type is used by a paticular node by using <code class="language-plaintext highlighter-rouge">rosnode info</code>. Messages can contain premitive datatypes or can be composed of multiple primitve datatypes. Here is an example <code class="language-plaintext highlighter-rouge">rosmsg show geometry_msgs/PointStamped</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>[geometry_msgs/PointStamped]:
std_msgs/Header header

uint32 seq  
time stamp  
string frame_id  

geometry_msgs/Point point

float64 x  
float64 y  
float64 z  
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="custom-messages">Custom Messages</h3>
<p>In situations where standard messages don’t do the job, you can create your own message types using the following steps.</p>

<ul>
  <li><strong>Create a <code class="language-plaintext highlighter-rouge">msg</code> folder in your package directory</strong></li>
  <li><strong>Create a new file named <code class="language-plaintext highlighter-rouge">YourMessage.msg</code> inside the msg folder.</strong></li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">Age.msg</code> should contain the message structure for example</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  Float32 Years   
  Float32 Months
  Float32 Days
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - find_package()</strong>
This is where all the packages required to COMPILE the messages of the topics, services, and actions go. In package.xml, you have to state them as build_depend.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>  find_package(catkin REQUIRED COMPONENTS
       rospy
       std_msgs
       message_generation   # Add message_generation here, after the other packages
  )
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - add_message_files()</strong> This function includes all of the messages of this package (in the msg folder) to be compiled. The file should look like this.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  add_message_files(
      FILES
      Age.msg
    ) # Dont Forget to UNCOMENT the parenthesis and add_message_files TOO
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - generate_messages()</strong> Here is where the packages needed for the messages compilation are imported.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  generate_messages(
      DEPENDENCIES
      std_msgs
  ) # Dont Forget to uncoment here TOO
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - catkin_package()</strong> State here all of the packages that will be needed by someone that executes something from your package. All of the packages stated here must be in the package.xml as exec_depend.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  catkin_package(
      CATKIN_DEPENDS rospy message_runtime   # This will NOT be the only thing here
  )
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the package.xml</strong>
Just add these 3 lines to the package.xml file.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  &lt;build_depend&gt;message_generation&lt;/build_depend&gt; 
  &lt;build_export_depend&gt;message_runtime&lt;/build_export_depend&gt;
  &lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Compile</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  roscd; cd ..
  catkin_make
  source devel/setup.bash
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Verification</strong>
  <code class="language-plaintext highlighter-rouge">rosmsg show Age</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  [topic_ex/Age]
  float32 years   
  float32 months   
  float32 days
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>Using these in ROS Nodes
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">package_name.msg</span> <span class="kn">import</span> <span class="n">Age</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h2 id="services">Services</h2>
<p>Messages over topics are not the only way nodes communicate with each other, Services are a synchronous way of commincation where a ROS program calls a service, and waits until it receives a result from the service before continuing.</p>

<p><strong>To view what services are currently being offered:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rosservice list</code></p>

<p><strong>For more information about a service:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rosservice info /service_name</code></p>

<p>This will return you the <code class="language-plaintext highlighter-rouge">name_of_the_package/Name_of_Service_message</code></p>

<p><strong>To call a service via terminal:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rosservice call /service_name /message_type arguments</code></p>

<h3 id="client">Client</h3>
<p>This is what CALLS the functionality provided by the Service Server. That is, it CALLS the Service Server.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="c1"># Import the service message used by the service /trajectory_by_name
</span><span class="kn">from</span> <span class="nn">trajectory_by_name_srv.srv</span> <span class="kn">import</span> <span class="n">TrajByName</span><span class="p">,</span> <span class="n">TrajByNameRequest</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'service_client'</span><span class="p">)</span>

<span class="n">rospy</span><span class="p">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/trajectory_by_name'</span><span class="p">)</span>
<span class="n">traj_by_name_service</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/trajectory_by_name'</span><span class="p">,</span> <span class="n">TrajByName</span><span class="p">)</span>
<span class="n">traj_by_name_object</span> <span class="o">=</span> <span class="n">TrajByNameRequest</span><span class="p">()</span>

<span class="n">traj_by_name_object</span><span class="p">.</span><span class="n">traj_name</span> <span class="o">=</span> <span class="s">"release_food"</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">traj_by_name_service</span><span class="p">(</span><span class="n">traj_by_name_object</span><span class="p">)</span>
<span class="k">print</span> <span class="n">result</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="service-messages">Service Messages</h3>
<p>ROS Services are defined by srv files, which contains a request message and a response message. These are identical to the messages used with ROS Topics (see rospy message overview). rospy converts these srv files into Python source code and creates three classes that you need to be familiar with: service definitions, request messages, and response messages. The names of these classes come directly from the srv filename:</p>

<p><code class="language-plaintext highlighter-rouge">my_package/srv/Foo.srv → my_package.srv.Foo</code></p>

<p><code class="language-plaintext highlighter-rouge">my_package/srv/Foo.srv → my_package.srv.FooRequest</code></p>

<p><code class="language-plaintext highlighter-rouge">my_package/srv/Foo.srv → my_package.srv.FooResponse</code></p>

<p>Service message files have the extension <code class="language-plaintext highlighter-rouge">.srv</code>. Remember that Topic message files have the extension <code class="language-plaintext highlighter-rouge">.msg</code>. Service message files are defined inside a srv directory. Remember that Topic message files are defined inside a msg directory.</p>

<p><strong>To see the structure of a srv message:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rossrv show name_of_the_package/Name_of_Service_message</code></p>

<p><strong>Service messages have TWO parts:</strong></p>

<p><strong>REQUEST</strong></p>

<p>The REQUEST is the part of the service message that defines HOW you will do a call to your service. This means, what variables you will have to pass to the Service Server so that it is able to complete its task.</p>

<p><strong>—</strong></p>

<p><strong>RESPONSE</strong></p>

<p>The RESPONSE is the part of the service message that defines HOW your service will respond after completing its functionality. If, for instance, it will return an string with a certaing message saying that everything went well, or if it will return nothing, etc…</p>

<h3 id="server">Server</h3>
<p>This is what PROVIDES the functionality. Whatever you want your Service to do, you have to place it in the Service Server.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">std_srvs.srv</span> <span class="kn">import</span> <span class="n">Empty</span><span class="p">,</span> <span class="n">EmptyResponse</span>

<span class="k">def</span> <span class="nf">my_callback</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">"My_callback has been called"</span>
    <span class="k">return</span> <span class="n">EmptyResponse</span><span class="p">()</span> <span class="c1"># the service Response class, in this case EmptyResponse
</span>
<span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'service_server'</span><span class="p">)</span> 
<span class="n">my_service</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Service</span><span class="p">(</span><span class="s">'/my_service'</span><span class="p">,</span> <span class="n">Empty</span> <span class="p">,</span> <span class="n">my_callback</span><span class="p">)</span> <span class="c1"># create the Service called my_service with the defined callback
</span><span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span> <span class="c1"># maintain the service open.
</span></pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="custom-service-messages">Custom Service Messages</h3>
<p>In order to create a service message, you will have to follow the next steps</p>
<ul>
  <li><strong>Create a <code class="language-plaintext highlighter-rouge">srv</code> folder in your package directory</strong></li>
  <li><strong>Create a new file named <code class="language-plaintext highlighter-rouge">MyCustomServiceMessage.srv</code> inside the srv folder.</strong></li>
  <li><code class="language-plaintext highlighter-rouge">MyCustomServiceMessage.srv</code> should contain the message structure for example
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  int32 duration  
  ---
  bool success
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - find_package()</strong>
This is where all the packages required to COMPILE the messages of the topics, services, and actions go. In package.xml, you have to state them as build_depend.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>find_package(catkin REQUIRED COMPONENTS
   rospy
   std_msgs
   message_generation   # Add message_generation here, after the other packages
)
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - add_service_files()</strong> 
This function includes all of the service messages of this package (in the srv folder) to be compiled. The file should look like this.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  add_service_files(
      FILES
      MyCustomServiceMessage.srv
    ) # Dont Forget to UNCOMENT the parenthesis and add_message_files TOO
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - generate_messages()</strong> 
Here is where the packages needed for the service messages compilation are imported.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  generate_messages(
      DEPENDENCIES
      std_msgs
  ) # Dont Forget to uncoment here TOO
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - catkin_package()</strong> 
State here all of the packages that will be needed by someone that executes something from your package. All of the packages stated here must be in the package.xml as exec_depend.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  catkin_package(
      CATKIN_DEPENDS rospy message_runtime   # This will NOT be the only thing here
  )
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the package.xml</strong>
Just add these 3 lines to the package.xml file.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  &lt;build_depend&gt;message_generation&lt;/build_depend&gt; 
  &lt;build_export_depend&gt;message_runtime&lt;/build_export_depend&gt;
  &lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Compile</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  roscd; cd ..
  catkin_make
  source devel/setup.bash
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Verification</strong>
<code class="language-plaintext highlighter-rouge">rossrv show package_name/MyCustomServiceMessage</code>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>[package_name/MyCustomServiceMessage]:   
int32 duration
---
bool success
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Using these in ROS Nodes</strong></p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>  <span class="kn">from</span> <span class="nn">package_name.srv</span> <span class="kn">import</span> <span class="n">MyCustomServiceMessage</span><span class="p">,</span> <span class="n">MyCustomServiceRequest</span><span class="o">/</span><span class="n">Responce</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>

<h2 id="actions">Actions</h2>
<p>Actions are like asynchronous calls to services, therefore are very similar to services. When you call an action, you are calling a functionality that another node is providing. Just the same as with services. The difference is that when your node calls a service, it must wait until the service finishes. When your node calls an action, it doesn’t necessarily have to wait for the action to complete.</p>

<p>Hence, an action is an asynchronous call to another node’s functionality.</p>

<p>The node that provides the functionality has to contain an action server. The action server allows other nodes to call that action functionality.
The node that calls to the functionality has to contain an action client. The action client allows a node to connect to the action server of another node.</p>

<p>When a robot provides an action, you will see that in the topics list. There are 5 topics with the same base name, and with the subtopics <strong>cancel, feedback, goal, result, and status.</strong></p>

<p><strong>For example, here the name of the action server is “ardrone_action_server”:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>```bash
user ~ $ rostopic list
...
...
/ardrone_action_server/cancel
/ardrone_action_server/feedback
/ardrone_action_server/goal
/ardrone_action_server/result
/ardrone_action_server/status
...
``` ### Calling an Action Server Calling an action server means sending a message to it. In the same way as with topics and services, it all works by passing messages around.
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>The message of a topic is composed of a single part: the information the topic provides.</li>
  <li>The message of a service has two parts: the request and the response.</li>
  <li>The message of an action server is divided into three parts: the goal, the result, and the feedback.</li>
</ul>

<p>For example, here is the message structure of an action server:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>user ~ <span class="nv">$ </span>roscd ardrone_as/action<span class="p">;</span> <span class="nb">cat </span>Ardrone.action
<span class="c">#goal for the drone</span>
int32 nseconds  <span class="c"># the number of seconds the drone will be taking pictures</span>
<span class="nt">---</span>
<span class="c">#result</span>
sensor_msgs/CompressedImage[] allPictures <span class="c"># an array containing all the pictures taken along the nseconds</span>
<span class="nt">---</span>
<span class="c">#feedback</span>
sensor_msgs/CompressedImage lastImage  <span class="c"># the last image taken</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="feedback">Feedback</h3>
<p>Due to the fact that calling an action server does not interrupt your thread, action servers provide a message called the feedback. The feedback is a message that the action server generates every once in a while to indicate how the action is going (informing the caller of the status of the requested action). It is generated while the action is in progress.</p>

<h3 id="working-explained">Working Explained</h3>
<p>So, whenever an action server is called, the sequence of steps are as follows:</p>

<p>1) When an <strong>action client</strong> calls an <strong>action server</strong> from a node, what actually happens is that the <strong>action client</strong> sends to the <strong>action server</strong> the goal requested through the <strong>/ardrone_action_server/goal</strong> topic.</p>

<p>2) When the <strong>action server</strong> starts to execute the goal, it sends to the <strong>action client</strong> the feedback through the <strong>/ardrone_action_server/feedback</strong> topic.</p>

<p>3) Finally, when the <strong>action server</strong> has finished the goal, it sends to the <strong>action client</strong> the result through the <strong>/ardrone_action_server/result</strong> topic.</p>

<h3 id="sending-goals-via-terminal">Sending Goals via terminal</h3>
<p>Each one of those three topics have their own type of message. The type of the message is built automatically by ROS from the .action file.</p>

<p>For example, in the case of the <strong>ardrone_action_server</strong> the action file is called <strong>Ardrone.action</strong>.</p>

<p>When you compile the package (with catkin_make), ROS will generate the following types of messages from the <strong>Ardrone.action</strong> file:</p>
<ul>
  <li>ArdroneActionGoal</li>
  <li>ArdroneActionFeedback</li>
  <li>ArdroneActionResult</li>
  <li>ArdroneAction</li>
  <li>ArdroneGoal</li>
  <li>ArdroneResult</li>
  <li>ArdroneFeedback</li>
</ul>

<p>Each topic of the action server uses its associated type of message accordingly.</p>

<p><strong>To send goals via the terminal:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rostopic pub /name_of_action_server/goal /type_of_the_message_used_by_the_topic parameters</code></p>

<h3 id="client-1">Client</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">actionlib</span>
<span class="kn">from</span> <span class="nn">ardrone_as.msg</span> <span class="kn">import</span> <span class="n">ArdroneAction</span><span class="p">,</span> <span class="n">ArdroneGoal</span><span class="p">,</span> <span class="n">ArdroneResult</span><span class="p">,</span> <span class="n">ArdroneFeedback</span>

<span class="n">nImage</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># definition of the feedback callback. This will be called when feedback
# is received from the action server
# it just prints a message indicating a new message has been received
</span><span class="k">def</span> <span class="nf">feedback_callback</span><span class="p">(</span><span class="n">feedback</span><span class="p">):</span>
	<span class="k">global</span> <span class="n">nImage</span>
	<span class="k">print</span><span class="p">(</span><span class="s">'[Feedback] image n.%d received'</span><span class="o">%</span><span class="n">nImage</span><span class="p">)</span>
	<span class="n">nImage</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># initializes the action client node
</span><span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'drone_action_client'</span><span class="p">)</span>

<span class="c1"># create the connection to the action server
</span><span class="n">client</span> <span class="o">=</span> <span class="n">actionlib</span><span class="p">.</span><span class="n">SimpleActionClient</span><span class="p">(</span><span class="s">'/ardrone_action_server'</span><span class="p">,</span> <span class="n">ArdroneAction</span><span class="p">)</span>
<span class="c1"># waits until the action server is up and running
</span><span class="n">client</span><span class="p">.</span><span class="n">wait_for_server</span><span class="p">()</span>

<span class="c1"># creates a goal to send to the action server
</span><span class="n">goal</span> <span class="o">=</span> <span class="n">ArdroneGoal</span><span class="p">()</span>
<span class="n">goal</span><span class="p">.</span><span class="n">nseconds</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># indicates, take pictures along 10 seconds
</span>
<span class="c1"># sends the goal to the action server, specifying which feedback function
# to call when feedback received
</span><span class="n">client</span><span class="p">.</span><span class="n">send_goal</span><span class="p">(</span><span class="n">goal</span><span class="p">,</span> <span class="n">feedback_cb</span><span class="o">=</span><span class="n">feedback_callback</span><span class="p">)</span>

<span class="c1"># Uncomment these lines to test goal preemption:
#time.sleep(3.0)
#client.cancel_goal()  # would cancel the goal 3 seconds after starting
</span>
<span class="c1"># wait until the result is obtained
# you can do other stuff here instead of waiting
# and check for status from time to time 
# status = client.get_state()
# check the client API link below for more info
</span>
<span class="n">client</span><span class="p">.</span><span class="n">wait_for_result</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s">'[Result] State: %d'</span><span class="o">%</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">get_state</span><span class="p">()))</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="how-to-perform-other-tasks-while-the-action-is-in-progress">How to perform other tasks while the Action is in progress</h3>
<p>So, the SimpleActionClient objects have two functions that can be used for knowing if the action that is being performed has finished, and how:</p>

<p>1) <strong>wait_for_result():</strong> This function is very simple. When called, it will wait until the action has finished and returns a true value. As you can see, it’s useless if you want to perform other tasks in parallel because the program will stop there until the action is finished.</p>

<p>2) <strong>get_state():</strong> This function is much more interesting. When called, it returns an integer that indicates in which state is the action that the SimpleActionClient object is connected to.</p>

<ul>
  <li>0 ==&gt; PENDING</li>
  <li>1 ==&gt; ACTIVE</li>
  <li>2 ==&gt; DONE</li>
  <li>3 ==&gt; WARN</li>
  <li>4 ==&gt; ERROR</li>
</ul>

<p>This allows you to create a while loop that checks if the value returned by get_state() is 2 or higher. If it is not, it means that the action is still in progress, so you can keep doing other things.</p>

<h3 id="preempting-a-goal">Preempting a goal</h3>
<p>It happens that you can cancel a goal previously sent to an action server prior to its completion. Cancelling a goal while it is being executed is called preempting a goal</p>

<p>You may need to preempt a goal for many reasons, like, for example, the robot went mad about your goal and it is safer to stop it prior to the robot doing some harm.</p>

<p>In order to preempt a goal, you send the cancel_goal to the server through the client connection.</p>

<p><code class="language-plaintext highlighter-rouge">client.cancel_goal()</code></p>

<h3 id="the-axclient">The axclient</h3>
<p>The axclient is, basically, a GUI tool provided by the actionlib package, that allows you to interact with an Action Server in a very easy and visual way.</p>

<p><strong>The command used to launch the axclient is the following:</strong></p>

<p><code class="language-plaintext highlighter-rouge">rosrun actionlib axclient.py /name_of_action_server</code></p>

<h3 id="server-1">Server</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre><span class="c1">#! /usr/bin/env python
</span>
<span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">Empty</span>
<span class="kn">from</span> <span class="nn">actions_quiz.msg</span> <span class="kn">import</span> <span class="n">CustomActionMsgAction</span><span class="p">,</span> <span class="n">CustomActionMsgGoal</span><span class="p">,</span> <span class="n">CustomActionMsgFeedback</span>
<span class="kn">import</span> <span class="nn">actionlib</span>

<span class="k">class</span> <span class="nc">DroneAction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">feedbackM</span> <span class="o">=</span> <span class="n">CustomActionMsgFeedback</span><span class="p">()</span>
    <span class="n">goalM</span> <span class="o">=</span> <span class="n">CustomActionMsgGoal</span><span class="p">()</span>
    <span class="n">emp</span> <span class="o">=</span> <span class="n">Empty</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pub_takeoff</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s">'drone/takeoff'</span><span class="p">,</span><span class="n">Empty</span><span class="p">,</span><span class="n">latch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pub_land</span> <span class="o">=</span> <span class="n">rospy</span><span class="p">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s">'drone/land'</span><span class="p">,</span><span class="n">Empty</span><span class="p">,</span><span class="n">latch</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">queue_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">server</span> <span class="o">=</span> <span class="n">actionlib</span><span class="p">.</span><span class="n">SimpleActionServer</span><span class="p">(</span><span class="s">'/action_custom_msg_as'</span><span class="p">,</span><span class="n">CustomActionMsgAction</span><span class="p">,</span><span class="bp">self</span><span class="p">.</span><span class="n">goal_callback</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">goal_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">goal</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">is_preempt_requested</span><span class="p">():</span>
                <span class="n">rospy</span><span class="p">.</span><span class="n">loginfo</span><span class="p">(</span><span class="s">'asked to quit'</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">set_preempted</span><span class="p">()</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">goal</span><span class="p">.</span><span class="n">goal</span> <span class="o">==</span> <span class="s">'TAKEOFF'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">pub_takeoff</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">goal</span><span class="p">.</span><span class="n">goal</span> <span class="o">==</span> <span class="s">'LAND'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">pub_land</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">emp</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">feedbackM</span><span class="p">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="n">goal</span><span class="p">.</span><span class="n">goal</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">publish_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">feedbackM</span><span class="p">)</span>
            <span class="n">rospy</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">emp</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">server</span><span class="p">.</span><span class="n">set_succeeded</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">result</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
  <span class="n">rospy</span><span class="p">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">'server_noder'</span><span class="p">)</span>
  <span class="n">DroneAction</span><span class="p">()</span>
  <span class="n">rospy</span><span class="p">.</span><span class="n">spin</span><span class="p">()</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p>Once the server is launched you should be able to see the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>rostopic list | <span class="nb">grep </span>action_custom_msg_as
    /action_custom_msg_as/cancel
    /action_custom_msg_as/feedback
    /action_custom_msg_as/goal
    /action_custom_msg_as/result
    /action_custom_msg_as/status
</pre></td></tr></tbody></table></code></pre></div></div>
<h3 id="custom-action-messages">Custom Action Messages</h3>
<p>In order to create a actiob message, you will have to follow the next steps:</p>

<ul>
  <li><strong>Create a action folder in your package directory</strong></li>
  <li><strong>Create a new file named Name.action inside the action folder.</strong></li>
  <li><code class="language-plaintext highlighter-rouge">Name.action</code> should contain the message structure for example
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>  int32 duration #Goal   
  ---   
  bool success #Result   
  ---   
  int32 current_time #Feedback
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - find_package()</strong>
This is where all the packages required to COMPILE the messages of the topics, services, and actions go. In package.xml, you have to state them as build_depend.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  find_package(catkin REQUIRED COMPONENTS
       rospy
       actionlib_msgs
  )
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the CMakeLists.txt - add_action_files()</strong> 
This function includes all of the action messages of this package (in the action folder) to be compiled. The file should look like this.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  add_action_files(
      FILES
      Name.action
    ) # Dont Forget to UNCOMENT the parenthesis
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Edit the CMakeLists.txt - generate_messages()</strong>
Here is where the packages needed for the service messages compilation are imported.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>  generate_messages(
      DEPENDENCIES
      actionlib_msgs
  ) # Dont Forget to uncoment here TOO
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Edit the CMakeLists.txt - catkin_package()</strong> 
State here all of the packages that will be needed by someone that executes something from your package. All of the packages stated here must be in the package.xml as exec_depend.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  catkin_package(
      CATKIN_DEPENDS rospy message_runtime   # This will NOT be the only thing here
  )
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Edit the package.xml</strong>
Just add these 3 lines to the package.xml file.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>  &lt;build_depend&gt;actionlib&lt;/build_depend&gt;
  &lt;build_depend&gt;actionlib_msgs&lt;/build_depend&gt;
  &lt;build_export_depend&gt;actionlib&lt;/build_export_depend&gt;
  &lt;build_export_depend&gt;actionlib_msgs&lt;/build_export_depend&gt;
  &lt;exec_depend&gt;actionlib&lt;/exec_depend&gt;
  &lt;exec_depend&gt;actionlib_msgs&lt;/exec_depend&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Compile</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>  roscd; cd ..
    catkin_make
    source devel/setup.bash
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Verification</strong></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  rosmsg list | grep Name          
    my_custom_action_msg_pkg/NameAction   
    my_custom_action_msg_pkg/NameActionFeedback  
    my_custom_action_msg_pkg/NameActionGoal  
    my_custom_action_msg_pkg/NameActionResult  
    my_custom_action_msg_pkg/NameFeedback  
    my_custom_action_msg_pkg/NameGoal   
    my_custom_action_msg_pkg/NameResult
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Using these in ROS Nodes</strong>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">my_custom_action_msg_pkg.msg</span> <span class="kn">import</span> <span class="n">NameAction</span><span class="p">,</span> <span class="n">NameGoal</span><span class="p">,</span> <span class="n">NameFeedback</span><span class="p">,</span> <span class="n">NameResult</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ul>
</div><section class="article__sharing d-print-none"><!-- Addthis BEGIN --><script type="text/javascript"
    src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-60e523a6b5396709"></script>
  <div class="addthis_inline_share_toolbox addthis_default_style"></div><!-- Addthis END -->
</section><div class="d-print-none"><footer class="article__footer"><meta itemprop="dateModified" content="2021-05-04T16:17:25+05:30"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet -->
<div class="article__license"><div class="license">
    <p>This work is licensed under a <a itemprop="license" rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">Attribution-NonCommercial 4.0 International</a> license.
      <a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/">
        <img alt="Attribution-NonCommercial 4.0 International" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" />
      </a>
    </p>
  </div></div></footer>
<div class="article__section-navigator clearfix"><div class="next"><span>NEXT</span><a href="/site/projects/2021-05-04-ROS-DUMMY.html">Dummy Page</a></div></div></div>

</div>
<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();
</script>

<h4>Related Posts</h4>
<!--Projects Related Posts-->

<div class="row">
<div class="relatedPosts">
    
    
    
    
    
    
    
    
 
    
    
    
    
    <div class="column">
      <div>
      <h5><a href="/site/projects/2021-05-04-ROS-DUMMY.html">
        <div class="card">
            <div class="card__image">
              <img class="image" src="/site/assets/images/fish.jpg"/>
            </div>
            <div class="card__content">
              <div class="card__header">
                <h4>Dummy Page</h4>
              </div>
              <p>ros</p>
            </div>
          </div>
      </a>
      </h5>
      </div>
    </div>
      
      
    
 
    
    
    
    
    <div class="column">
      <div>
      <h5><a href="/site/projects/2021-05-04-ROS-TF101.html">
        <div class="card">
            <div class="card__image">
              <img class="image" src="/site/assets/images/fish.jpg"/>
            </div>
            <div class="card__content">
              <div class="card__header">
                <h4>TF101</h4>
              </div>
              <p>ros</p>
            </div>
          </div>
      </a>
      </h5>
      </div>
    </div>
      
      
    
 
</div>
</div>


<!-- Resources Related Posts
 -->

<!--Blog Related Posts-->



<style>
  * {
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

/* Float four columns side by side */
.column {
  float: left;
  width: 25%;
  padding: 0 10px;
}

/* Remove extra left and right margins, due to padding in columns */
.row {margin: 0 -5px;}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

/* Style the counter cards */
.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); /* this adds the "card" effect */
  padding: 16px;
  text-align: center;
  background-color: #121212;
}

/* Responsive columns - one column layout (vertical) on small screens */
@media screen and (max-width: 600px) {
  .column {
    width: 100%;
    display: block;
    margin-bottom: 20px;
  }
}
</style>

<script src="https://utteranc.es/client.js"
        repo="arc-bphc/arc-bphc.github.io"
        issue-term="title"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script>
</div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet -->
</div>
            </div></div></div><div class="page__footer d-print-none">
<footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Automation  & Robotics Club"><meta itemprop="url" content="https://arc-bphc.github.io"><meta itemprop="description" content="I am an amazing person."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><link itemprop="url" href="https://arc-bphc.github.io"><li title="Send me an Email.">
      <a class="button button--circle mail-button" itemprop="email" href="https://mail.google.com/mail/?view=cm&fs=1&to=arc@hyderabad.bits-pilani.ac.in" target="_blank">
        <i class="fas fa-envelope"></i>
      </a><li title="Follow me on Facebook.">
        <a class="button button--circle facebook-button" itemprop="sameAs" href="https://www.facebook.com/automationandroboticsclub" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M767.428571 6.857143l0 150.857143-89.714286 0q-49.142857 0-66.285714 20.571429t-17.142857 61.714286l0 108 167.428571 0-22.285714 169.142857-145.142857 0 0 433.714286-174.857143 0 0-433.714286-145.714286 0 0-169.142857 145.714286 0 0-124.571429q0-106.285714 59.428571-164.857143t158.285714-58.571429q84 0 130.285714 6.857143z" />
</svg>
</div>
        </a>
      </li><li title="Follow me on Github.">
        <a class="button button--circle github-button" itemprop="sameAs" href="https://github.com/arc-bphc" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z" />
</svg>
</div>
        </a>
      </li></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>© Automation & Robotics Club 2021,
        Powered by <a title="Jekyll is a simple, blog-aware, static site generator." href="http://jekyllrb.com/">Jekyll</a> & <a
        title="TeXt is a super customizable Jekyll theme." href="https://github.com/kitian616/jekyll-TeXt-theme">TeXt Theme</a>.
      </div>
    </div>
  </div>
</footer>
</div></div>
    </div><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $body = $('body'), $window = $(window);
    var $pageRoot = $('.js-page-root'), $pageMain = $('.js-page-main');
    var activeCount = 0;
    function modal(options) {
      var $root = this, visible, onChange, hideWhenWindowScroll = false;
      var scrollTop;
      function setOptions(options) {
        var _options = options || {};
        visible = _options.initialVisible === undefined ? false : show;
        onChange = _options.onChange;
        hideWhenWindowScroll = _options.hideWhenWindowScroll;
      }
      function init() {
        setState(visible);
      }
      function setState(isShow) {
        if (isShow === visible) {
          return;
        }
        visible = isShow;
        if (visible) {
          activeCount++;
          scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
          $root.addClass('modal--show');
          $pageMain.scrollTop(scrollTop);
          activeCount === 1 && ($pageRoot.addClass('show-modal'), $body.addClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.on('scroll', hide);
          $window.on('keyup', handleKeyup);
        } else {
          activeCount > 0 && activeCount--;
          $root.removeClass('modal--show');
          $window.scrollTop(scrollTop);
          activeCount === 0 && ($pageRoot.removeClass('show-modal'), $body.removeClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.off('scroll', hide);
          $window.off('keyup', handleKeyup);
        }
        onChange && onChange(visible);
      }
      function show() {
        setState(true);
      }
      function hide() {
        setState(false);
      }
      function handleKeyup(e) {
        // Char Code: 27  ESC
        if (e.which ===  27) {
          hide();
        }
      }
      setOptions(options);
      init();
      return {
        show: show,
        hide: hide,
        $el: $root
      };
    }
    $.fn.modal = modal;
  });
})();
</script><div class="modal modal--overflow page__search-modal d-print-none js-page-search-modal"><script>
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    // search panel
    var search = (window.search || (window.search = {}));
    var useDefaultSearchBox = window.useDefaultSearchBox === undefined ?
      true : window.useDefaultSearchBox ;

    var $searchModal = $('.js-page-search-modal');
    var $searchToggle = $('.js-search-toggle');
    var searchModal = $searchModal.modal({ onChange: handleModalChange, hideWhenWindowScroll: true });
    var modalVisible = false;
    search.searchModal = searchModal;

    var $searchBox = null;
    var $searchInput = null;
    var $searchClear = null;

    function getModalVisible() {
      return modalVisible;
    }
    search.getModalVisible = getModalVisible;

    function handleModalChange(visible) {
      modalVisible = visible;
      if (visible) {
        search.onShow && search.onShow();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].focus();
      } else {
        search.onShow && search.onHide();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].blur();
        setTimeout(function() {
          useDefaultSearchBox && ($searchInput.val(''), $searchBox.removeClass('not-empty'));
          search.clear && search.clear();
          window.pageAsideAffix && window.pageAsideAffix.refresh();
        }, 400);
      }
    }

    $searchToggle.on('click', function() {
      modalVisible ? searchModal.hide() : searchModal.show();
    });
    // Char Code: 83  S, 191 /
    $(window).on('keyup', function(e) {
      if (!modalVisible && !window.isFormElement(e.target || e.srcElement) && (e.which === 83 || e.which === 191)) {
        modalVisible || searchModal.show();
      }
    });

    if (useDefaultSearchBox) {
      $searchBox = $('.js-search-box');
      $searchInput = $searchBox.children('input');
      $searchClear = $searchBox.children('.js-icon-clear');
      search.getSearchInput = function() {
        return $searchInput.get(0);
      };
      search.getVal = function() {
        return $searchInput.val();
      };
      search.setVal = function(val) {
        $searchInput.val(val);
      };

      $searchInput.on('focus', function() {
        $(this).addClass('focus');
      });
      $searchInput.on('blur', function() {
        $(this).removeClass('focus');
      });
      $searchInput.on('input', window.throttle(function() {
        var val = $(this).val();
        if (val === '' || typeof val !== 'string') {
          search.clear && search.clear();
        } else {
          $searchBox.addClass('not-empty');
          search.onInputNotEmpty && search.onInputNotEmpty(val);
        }
      }, 400));
      $searchClear.on('click', function() {
        $searchInput.val(''); $searchBox.removeClass('not-empty');
        search.clear && search.clear();
      });
    }
  });
})();
</script><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--theme-dark button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>
<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var search = (window.search || (window.search = {}));
  var searchData = window.TEXT_SEARCH_DATA || {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) { return null; }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function clear() {
    $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }
  function onInputNotEmpty(val) {
    $result.html(render(searchByQuery(val)));
    $resultItems = $('.search-result__item'); activeIndex = 0;
    $resultItems.eq(0).addClass('active');
  }

  search.clear = clear;
  search.onInputNotEmpty = onInputNotEmpty;

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  // Char Code: 13  Enter, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇
  $(window).on('keyup', function(e) {
    var modalVisible = search.getModalVisible && search.getModalVisible();
    if (modalVisible) {
      if (e.which === 38) {
        modalVisible && moveActiveIndex('up');
      } else if (e.which === 40) {
        modalVisible && moveActiveIndex('down');
      } else if (e.which === 13) {
        modalVisible && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });
});
</script>
</div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true, { animation: false }); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc toc--ellipsis"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();
/*(function () {

})();*/
</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();
</script>
    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();
</script>
  </body>
</html>



